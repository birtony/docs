<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1182px" preserveAspectRatio="none" style="width:910px;height:1182px;background:#FFFFFF;" version="1.1" viewBox="0 0 910 1182" width="910px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="109.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="49.5" y="114.7266"/><rect fill="#FFFFFF" height="816.3828" style="stroke:#181818;stroke-width:1.0;" width="10" x="149" y="253.5234"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="345" y="282.6563"/><rect fill="#FFFFFF" height="321.8594" style="stroke:#181818;stroke-width:1.0;" width="10" x="422" y="398.1875"/><rect fill="#FFFFFF" height="94.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="509.5" y="749.1797"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="588.5" y="872.8438"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="678.5" y="522.9844"/><rect fill="#FFFFFF" height="109.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="775" y="581.25"/><rect fill="#FFFFFF" height="109.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="865.5" y="931.1094"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="54" x2="54" y1="83.5938" y2="1087.9063"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="154" x2="154" y1="83.5938" y2="1087.9063"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="350" x2="350" y1="83.5938" y2="1087.9063"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="427" x2="427" y1="83.5938" y2="1087.9063"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="514" x2="514" y1="83.5938" y2="1087.9063"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="593" x2="593" y1="83.5938" y2="1087.9063"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="683" x2="683" y1="83.5938" y2="1087.9063"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="780" x2="780" y1="83.5938" y2="1087.9063"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="870" x2="870" y1="83.5938" y2="1087.9063"/><path d="M10,57.2969 L99,57.2969 C104,57.2969 104,70.4453 104,70.4453 C104,70.4453 104,83.5938 99,83.5938 L10,83.5938 C5,83.5938 5,70.4453 5,70.4453 C5,70.4453 5,57.2969 10,57.2969 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M99,57.2969 C94,57.2969 94,70.4453 94,70.4453 C94,83.5938 99,83.5938 99,83.5938 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="10" y="75.292">orb.anchor</text><path d="M10,1086.9063 L99,1086.9063 C104,1086.9063 104,1100.0547 104,1100.0547 C104,1100.0547 104,1113.2031 99,1113.2031 L10,1113.2031 C5,1113.2031 5,1100.0547 5,1100.0547 C5,1100.0547 5,1086.9063 10,1086.9063 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M99,1086.9063 C94,1086.9063 94,1100.0547 94,1100.0547 C94,1113.2031 99,1113.2031 99,1113.2031 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="10" y="1104.9014">orb.anchor</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80" x="114" y="52.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="121" y="72.292">Observer</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80" x="114" y="1086.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="121" y="1106.9014">Observer</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="332.5" y="80.292">CAS</text><path d="M332,31.2969 C332,21.2969 350,21.2969 350,21.2969 C350,21.2969 368,21.2969 368,31.2969 L368,57.2969 C368,67.2969 350,67.2969 350,67.2969 C350,67.2969 332,67.2969 332,57.2969 L332,31.2969 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M332,31.2969 C332,41.2969 350,41.2969 350,41.2969 C350,41.2969 368,41.2969 368,31.2969 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="332.5" y="1099.9014">CAS</text><path d="M332,1113.2031 C332,1103.2031 350,1103.2031 350,1103.2031 C350,1103.2031 368,1103.2031 368,1113.2031 L368,1139.2031 C368,1149.2031 350,1149.2031 350,1149.2031 C350,1149.2031 332,1149.2031 332,1139.2031 L332,1113.2031 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M332,1113.2031 C332,1123.2031 350,1123.2031 350,1123.2031 C350,1123.2031 368,1123.2031 368,1113.2031 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="378" y="36"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="385" y="55.9951">Transaction</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="392" y="72.292">Processor</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="378" y="1086.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="385" y="1106.9014">Transaction</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="392" y="1123.1982">Processor</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26" x="498.5" y="63.9951">DID</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="486" y="80.292">Anchor</text><path d="M496.5,15 C496.5,5 514.5,5 514.5,5 C514.5,5 532.5,5 532.5,15 L532.5,41 C532.5,51 514.5,51 514.5,51 C514.5,51 496.5,51 496.5,41 L496.5,15 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M496.5,15 C496.5,25 514.5,25 514.5,25 C514.5,25 532.5,25 532.5,15 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26" x="498.5" y="1099.9014">DID</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="486" y="1116.1982">Anchor</text><path d="M496.5,1129.5 C496.5,1119.5 514.5,1119.5 514.5,1119.5 C514.5,1119.5 532.5,1119.5 532.5,1129.5 L532.5,1155.5 C532.5,1165.5 514.5,1165.5 514.5,1165.5 C514.5,1165.5 496.5,1165.5 496.5,1155.5 L496.5,1129.5 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M496.5,1129.5 C496.5,1139.5 514.5,1139.5 514.5,1139.5 C514.5,1139.5 532.5,1139.5 532.5,1129.5 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="565" y="63.9951">Anchor</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="553" y="80.292">Reference</text><path d="M575.5,15 C575.5,5 593.5,5 593.5,5 C593.5,5 611.5,5 611.5,15 L611.5,41 C611.5,51 593.5,51 593.5,51 C593.5,51 575.5,51 575.5,41 L575.5,15 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M575.5,15 C575.5,25 593.5,25 593.5,25 C593.5,25 611.5,25 611.5,15 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="565" y="1099.9014">Anchor</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="553" y="1116.1982">Reference</text><path d="M575.5,1129.5 C575.5,1119.5 593.5,1119.5 593.5,1119.5 C593.5,1119.5 611.5,1119.5 611.5,1129.5 L611.5,1155.5 C611.5,1165.5 593.5,1165.5 593.5,1165.5 C593.5,1165.5 575.5,1165.5 575.5,1155.5 L575.5,1129.5 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M575.5,1129.5 C575.5,1139.5 593.5,1139.5 593.5,1139.5 C593.5,1139.5 611.5,1139.5 611.5,1129.5 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="644" y="80.292">Operation</text><path d="M665.5,31.2969 C665.5,21.2969 683.5,21.2969 683.5,21.2969 C683.5,21.2969 701.5,21.2969 701.5,31.2969 L701.5,57.2969 C701.5,67.2969 683.5,67.2969 683.5,67.2969 C683.5,67.2969 665.5,67.2969 665.5,57.2969 L665.5,31.2969 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M665.5,31.2969 C665.5,41.2969 683.5,41.2969 683.5,41.2969 C683.5,41.2969 701.5,41.2969 701.5,31.2969 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="644" y="1099.9014">Operation</text><path d="M665.5,1113.2031 C665.5,1103.2031 683.5,1103.2031 683.5,1103.2031 C683.5,1103.2031 701.5,1103.2031 701.5,1113.2031 L701.5,1139.2031 C701.5,1149.2031 683.5,1149.2031 683.5,1149.2031 C683.5,1149.2031 665.5,1149.2031 665.5,1139.2031 L665.5,1113.2031 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M665.5,1113.2031 C665.5,1123.2031 683.5,1123.2031 683.5,1123.2031 C683.5,1123.2031 701.5,1123.2031 701.5,1113.2031 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88" x="733" y="63.9951">Unpublished</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="740.5" y="80.292">Operation</text><path d="M762,15 C762,5 780,5 780,5 C780,5 798,5 798,15 L798,41 C798,51 780,51 780,51 C780,51 762,51 762,41 L762,15 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M762,15 C762,25 780,25 780,25 C780,25 798,25 798,15 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88" x="733" y="1099.9014">Unpublished</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="740.5" y="1116.1982">Operation</text><path d="M762,1129.5 C762,1119.5 780,1119.5 780,1119.5 C780,1119.5 798,1119.5 798,1129.5 L798,1155.5 C798,1165.5 780,1165.5 780,1165.5 C780,1165.5 762,1165.5 762,1155.5 L762,1129.5 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M762,1129.5 C762,1139.5 780,1139.5 780,1139.5 C780,1139.5 798,1139.5 798,1129.5 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="67" x="837" y="52.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="844" y="72.292">Outbox</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="67" x="837" y="1086.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="844" y="1106.9014">Outbox</text><rect fill="#FFFFFF" height="109.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="49.5" y="114.7266"/><rect fill="#FFFFFF" height="816.3828" style="stroke:#181818;stroke-width:1.0;" width="10" x="149" y="253.5234"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="345" y="282.6563"/><rect fill="#FFFFFF" height="321.8594" style="stroke:#181818;stroke-width:1.0;" width="10" x="422" y="398.1875"/><rect fill="#FFFFFF" height="94.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="509.5" y="749.1797"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="588.5" y="872.8438"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="678.5" y="522.9844"/><rect fill="#FFFFFF" height="109.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="775" y="581.25"/><rect fill="#FFFFFF" height="109.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="865.5" y="931.1094"/><polygon fill="#181818" points="70.5,110.7266,60.5,114.7266,70.5,118.7266,66.5,114.7266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="64.5" x2="153" y1="114.7266" y2="114.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="76.5" y="109.6606">Subscribe</text><path d="M55,127.7266 L55,197.7266 L253,197.7266 L253,137.7266 L243,127.7266 L55,127.7266 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M243,127.7266 L243,137.7266 L253,137.7266 L243,127.7266 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="61" y="144.7935">On startup the Observer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="61" y="159.9263">subscribes to the anchor</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="61" y="175.0591">queue to receive witnessed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="61" y="190.1919">anchor linksets.</text><polygon fill="#181818" points="142,220.3906,152,224.3906,142,228.3906,146,224.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="54.5" x2="148" y1="224.3906" y2="224.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="61.5" y="219.3247">ok</text><polygon fill="#181818" points="137,249.5234,147,253.5234,137,257.5234,141,253.5234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="54.5" x2="143" y1="253.5234" y2="253.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="61.5" y="248.4575">anchor info</text><polygon fill="#181818" points="333,278.6563,343,282.6563,333,286.6563,337,282.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="159" x2="339" y1="282.6563" y2="282.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="166" y="277.5903">Read(anchorInfo.hashlink)</text><polygon fill="#181818" points="170,307.7891,160,311.7891,170,315.7891,166,311.7891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="164" x2="349" y1="311.7891" y2="311.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="176" y="306.7231">anchorLinkset</text><line style="stroke:#181818;stroke-width:1.0;" x1="159" x2="201" y1="356.0547" y2="356.0547"/><line style="stroke:#181818;stroke-width:1.0;" x1="201" x2="201" y1="356.0547" y2="369.0547"/><line style="stroke:#181818;stroke-width:1.0;" x1="160" x2="201" y1="369.0547" y2="369.0547"/><polygon fill="#181818" points="170,365.0547,160,369.0547,170,373.0547,166,369.0547" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="166" y="335.856">Convert anchorLinkset</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="166" y="350.9888">to Sidetree Txn</text><polygon fill="#181818" points="410,394.1875,420,398.1875,410,402.1875,414,398.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="159" x2="416" y1="398.1875" y2="398.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="166" y="393.1216">Process(Sidetree Txn)</text><path d="M334,411.1875 L334,496.1875 L520,496.1875 L520,421.1875 L510,411.1875 L334,411.1875 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M510,411.1875 L510,421.1875 L520,421.1875 L510,411.1875 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="340" y="428.2544">Validate and convert</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="340" y="443.3872">the Sidetree transaction</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="340" y="458.52">into operation documents</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="340" y="473.6528">and store them in the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="340" y="488.7856">operation database.</text><polygon fill="#181818" points="666.5,518.9844,676.5,522.9844,666.5,526.9844,670.5,522.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="672.5" y1="522.9844" y2="522.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="439" y="517.9185">Put(operations)</text><polygon fill="#181818" points="443,548.1172,433,552.1172,443,556.1172,439,552.1172" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="437" x2="682.5" y1="552.1172" y2="552.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="449" y="547.0513">ok</text><polygon fill="#181818" points="763,577.25,773,581.25,763,585.25,767,581.25" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="432" x2="769" y1="581.25" y2="581.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="439" y="576.1841">DeleteAll(operations)</text><path d="M334,594.25 L334,664.25 L520,664.25 L520,604.25 L510,594.25 L334,594.25 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M510,594.25 L510,604.25 L520,604.25 L510,594.25 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="340" y="611.3169">Delete the operations</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="340" y="626.4497">from the 'unpublished</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="340" y="641.5825">operation' database since</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="340" y="656.7153">they are now published.</text><polygon fill="#181818" points="443,686.9141,433,690.9141,443,694.9141,439,690.9141" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="437" x2="779" y1="690.9141" y2="690.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="449" y="685.8481">ok</text><polygon fill="#181818" points="170,716.0469,160,720.0469,170,724.0469,166,720.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="164" x2="426" y1="720.0469" y2="720.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="176" y="714.981">ok</text><polygon fill="#181818" points="497.5,745.1797,507.5,749.1797,497.5,753.1797,501.5,749.1797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="159" x2="503.5" y1="749.1797" y2="749.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="166" y="744.1138">PutBulk(suffixes,anchor)</text><path d="M52,762.1797 L52,817.1797 L256,817.1797 L256,772.1797 L246,762.1797 L52,762.1797 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M246,762.1797 L246,772.1797 L256,772.1797 L246,762.1797 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="58" y="779.2466">Add an entry for each DID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="58" y="794.3794">suffix in the anchor linkset</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="58" y="809.5122">to reference the new anchor</text><polygon fill="#181818" points="170,839.7109,160,843.7109,170,847.7109,166,843.7109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="164" x2="513.5" y1="843.7109" y2="843.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="176" y="838.645">ok</text><polygon fill="#181818" points="576.5,868.8438,586.5,872.8438,576.5,876.8438,580.5,872.8438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="159" x2="582.5" y1="872.8438" y2="872.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="166" y="867.7778">Put(anchor hashlink)</text><polygon fill="#181818" points="170,897.9766,160,901.9766,170,905.9766,166,901.9766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="164" x2="592.5" y1="901.9766" y2="901.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="176" y="896.9106">ok</text><polygon fill="#181818" points="853.5,927.1094,863.5,931.1094,853.5,935.1094,857.5,931.1094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="159" x2="859.5" y1="931.1094" y2="931.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="166" y="926.0435">Post(Like)</text><path d="M44,944.1094 L44,1014.1094 L264,1014.1094 L264,954.1094 L254,944.1094 L44,944.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M254,944.1094 L254,954.1094 L264,954.1094 L254,944.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174" x="50" y="961.1763">A 'Like' activity is posted to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="50" y="976.3091">the anchor origin to indicate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="50" y="991.4419">that this domain has replicated</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="50" y="1006.5747">the anchor linkset.</text><polygon fill="#181818" points="170,1036.7734,160,1040.7734,170,1044.7734,166,1040.7734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="164" x2="869.5" y1="1040.7734" y2="1040.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="176" y="1035.7075">ok</text><polygon fill="#181818" points="65.5,1065.9063,55.5,1069.9063,65.5,1073.9063,61.5,1069.9063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="59.5" x2="153" y1="1069.9063" y2="1069.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="71.5" y="1064.8403">Ack</text><!--MD5=[2e7942e326c57d96b9fd39d3ce5f7695]
@startuml
'https://plantuml.com/sequence-diagram

queue "orb.anchor" as anchorQueue

participant "Observer" as observer

database "CAS" as cas
participant "Transaction\nProcessor" as txnProcessor
database "DID\nAnchor" as didAnchorDB
database "Anchor\nReference" as anchorRefDB
database "Operation" as operationDB
database "Unpublished\nOperation" as unpublishedOperationDB

participant "Outbox" as outbox

observer -> anchorQueue: Subscribe
note over observer
  On startup the Observer
  subscribes to the anchor
  queue to receive witnessed
  anchor linksets.
end note
activate anchorQueue
  anchorQueue - -> observer: ok
deactivate anchorQueue

anchorQueue -> observer: anchor info

activate observer
  observer -> cas: Read(anchorInfo.hashlink)
  activate cas
    cas - -> observer: anchorLinkset
  deactivate cas

  observer -> observer: Convert anchorLinkset\nto Sidetree Txn

  observer -> txnProcessor: Process(Sidetree Txn)
  activate txnProcessor
    note over txnProcessor
      Validate and convert
      the Sidetree transaction
      into operation documents
      and store them in the
      operation database.
    end note

    txnProcessor -> operationDB: Put(operations)
    activate operationDB
      operationDB - -> txnProcessor: ok
    deactivate operationDB

    txnProcessor -> unpublishedOperationDB: DeleteAll(operations)
    note over txnProcessor
      Delete the operations
      from the 'unpublished
      operation' database since
      they are now published.
    end note
    activate unpublishedOperationDB
      unpublishedOperationDB - -> txnProcessor: ok
    deactivate unpublishedOperationDB

    txnProcessor - -> observer: ok
  deactivate txnProcessor

  observer -> didAnchorDB: PutBulk(suffixes,anchor)
  activate didAnchorDB
    note over observer
      Add an entry for each DID
      suffix in the anchor linkset
      to reference the new anchor
    end note
    didAnchorDB - -> observer: ok
  deactivate didAnchorDB

  observer -> anchorRefDB: Put(anchor hashlink)
  activate anchorRefDB
    anchorRefDB - -> observer: ok
  deactivate anchorRefDB

  observer -> outbox: Post(Like)
  activate outbox
    note over observer
      A 'Like' activity is posted to
      the anchor origin to indicate
      that this domain has replicated
      the anchor linkset.
    end note
    outbox - -> observer: ok
  deactivate outbox

  observer - -> anchorQueue: Ack
deactivate observer
@enduml

@startuml

queue "orb.anchor" as anchorQueue

participant "Observer" as observer

database "CAS" as cas
participant "Transaction\nProcessor" as txnProcessor
database "DID\nAnchor" as didAnchorDB
database "Anchor\nReference" as anchorRefDB
database "Operation" as operationDB
database "Unpublished\nOperation" as unpublishedOperationDB

participant "Outbox" as outbox

observer -> anchorQueue: Subscribe
note over observer
  On startup the Observer
  subscribes to the anchor
  queue to receive witnessed
  anchor linksets.
end note
activate anchorQueue
  anchorQueue - -> observer: ok
deactivate anchorQueue

anchorQueue -> observer: anchor info

activate observer
  observer -> cas: Read(anchorInfo.hashlink)
  activate cas
    cas - -> observer: anchorLinkset
  deactivate cas

  observer -> observer: Convert anchorLinkset\nto Sidetree Txn

  observer -> txnProcessor: Process(Sidetree Txn)
  activate txnProcessor
    note over txnProcessor
      Validate and convert
      the Sidetree transaction
      into operation documents
      and store them in the
      operation database.
    end note

    txnProcessor -> operationDB: Put(operations)
    activate operationDB
      operationDB - -> txnProcessor: ok
    deactivate operationDB

    txnProcessor -> unpublishedOperationDB: DeleteAll(operations)
    note over txnProcessor
      Delete the operations
      from the 'unpublished
      operation' database since
      they are now published.
    end note
    activate unpublishedOperationDB
      unpublishedOperationDB - -> txnProcessor: ok
    deactivate unpublishedOperationDB

    txnProcessor - -> observer: ok
  deactivate txnProcessor

  observer -> didAnchorDB: PutBulk(suffixes,anchor)
  activate didAnchorDB
    note over observer
      Add an entry for each DID
      suffix in the anchor linkset
      to reference the new anchor
    end note
    didAnchorDB - -> observer: ok
  deactivate didAnchorDB

  observer -> anchorRefDB: Put(anchor hashlink)
  activate anchorRefDB
    anchorRefDB - -> observer: ok
  deactivate anchorRefDB

  observer -> outbox: Post(Like)
  activate outbox
    note over observer
      A 'Like' activity is posted to
      the anchor origin to indicate
      that this domain has replicated
      the anchor linkset.
    end note
    outbox - -> observer: ok
  deactivate outbox

  observer - -> anchorQueue: Ack
deactivate observer
@enduml

PlantUML version 1.2022.5(Sat Apr 30 10:55:52 UTC 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>